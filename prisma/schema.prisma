generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id                 String       @id @default(uuid())
  email              String       @unique
  displayName        String?
  createdAt          DateTime     @default(now())
  password           String
  bracketSubmitted   Boolean      @default(false)
  bracketSubmittedAt DateTime?
  predictions        Prediction[]

  @@map("users")
}

model Match {
  id          String       @id @default(uuid())
  round       Int
  matchNumber Int
  team1       String
  team2       String
  winner      String?
  completed   Boolean      @default(false)
  matchDate   DateTime
  scrapedAt   DateTime?
  createdAt   DateTime     @default(now())
  updatedAt   DateTime     @updatedAt
  team1Logo   String?
  team1Seed   Int?
  team2Logo   String?
  team2Seed   Int?
  team1Sets   Int?
  team2Sets   Int?
  predictions Prediction[]

  @@map("matches")
}

model Prediction {
  id                 String   @id @default(uuid())
  userId             String
  matchId            String
  predictedWinner    String
  predictedTotalSets Int
  pointsEarned       Float?
  createdAt          DateTime @default(now())
  match              Match    @relation(fields: [matchId], references: [id], onDelete: Cascade)
  user               User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([userId, matchId])
  @@index([userId])
  @@index([matchId])
  @@map("predictions")
}
